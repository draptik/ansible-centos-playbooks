- name: Ensure Readeck data directory exists
  ansible.builtin.file:
    path: "{{ readeck_data_dir }}"
    state: directory
    owner: root
    group: root
    mode: "0755"

- name: Deploy Readeck container
  containers.podman.podman_container:
    name: "{{ readeck_container_name }}"
    image: "{{ readeck_image }}"
    state: started
    restart_policy: always
    ports:
      - "8081:8000/tcp"
    volume:
      - "{{ readeck_data_dir }}:/data:z"
    env:
      READECK_ALLOWED_HOSTS: "{{ readeck_allowed_hosts }}"
      READECK_USE_X_FORWARDED: "true"
